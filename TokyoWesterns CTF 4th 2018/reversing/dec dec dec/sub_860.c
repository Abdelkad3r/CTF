/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2017 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 (**init_proc())(void);
// char *strncpy(char *dest, const char *src, size_t n);
// int puts(const char *s);
// size_t strlen(const char *s);
// int strcmp(const char *s1, const char *s2);
// void *malloc(size_t size);
// void __noreturn exit(int status);
// __int64 __fastcall _cxa_finalize(_QWORD); weak
__int64 (**sub_760())(void);
__int64 (**sub_7F0())(void);
__int64 sub_830();
_BYTE *__fastcall sub_860(const char *a1);
void *__fastcall sub_BE7(const char *a1);
char *__fastcall sub_F59(const char *a1);
__int64 __fastcall main(int a1, char **a2, char **a3);
void __fastcall init(unsigned int a1, __int64 a2, __int64 a3);
void term_proc();
// __int64 ITM_deregisterTMCloneTable(void); weak
// __int64 _gmon_start__(void); weak
// __int64 Jv_RegisterClasses(void); weak

//-------------------------------------------------------------------------
// Data declarations

__int64 (__fastcall *off_201DA8[2])() = { &sub_830, &sub_7F0 }; // weak
__int64 (__fastcall *off_201DB0)() = &sub_7F0; // weak
_UNKNOWN unk_201DB8; // weak
void *off_202008 = &off_202008; // weak
char *s2 = "@25-Q44E233=,>E-M34=,,$LS5VEQ45)M2S-),7-$/3T "; // idb
char byte_202018; // weak
_UNKNOWN unk_20201F; // weak
// extern _UNKNOWN __cxa_finalize; weak


//----- (00000000000006C0) ----------------------------------------------------
__int64 (**init_proc())(void)
{
  __int64 (**result)(void); // rax

  result = &_gmon_start__;
  if ( &_gmon_start__ )
    result = (__int64 (**)(void))_gmon_start__();
  return result;
}
// 202070: using guessed type __int64 _gmon_start__(void);

//----- (0000000000000730) ----------------------------------------------------
#error "736: positive sp value has been found (funcsize=3)"

//----- (0000000000000760) ----------------------------------------------------
__int64 (**sub_760())(void)
{
  __int64 (**result)(void); // rax

  result = (__int64 (**)(void))(&unk_20201F - (_UNKNOWN *)&byte_202018);
  if ( (unsigned __int64)(&unk_20201F - (_UNKNOWN *)&byte_202018) > 0xE )
  {
    result = &ITM_deregisterTMCloneTable;
    if ( &ITM_deregisterTMCloneTable )
      result = (__int64 (**)(void))ITM_deregisterTMCloneTable();
  }
  return result;
}
// 202018: using guessed type char byte_202018;
// 202068: using guessed type __int64 ITM_deregisterTMCloneTable(void);

//----- (00000000000007F0) ----------------------------------------------------
__int64 (**sub_7F0())(void)
{
  __int64 (**result)(void); // rax

  if ( !byte_202018 )
  {
    if ( &__cxa_finalize )
      _cxa_finalize(off_202008);
    result = sub_760();
    byte_202018 = 1;
  }
  return result;
}
// 728: using guessed type __int64 __fastcall _cxa_finalize(_QWORD);
// 202008: using guessed type void *off_202008;
// 202018: using guessed type char byte_202018;

//----- (0000000000000830) ----------------------------------------------------
__int64 sub_830()
{
  if ( unk_201DB8 && &Jv_RegisterClasses )
    Jv_RegisterClasses();
  return 0LL;
}
// 202078: using guessed type __int64 Jv_RegisterClasses(void);

//----- (0000000000000860) ----------------------------------------------------
_BYTE *__fastcall sub_860(const char *a1)
{
  unsigned int v1; // ST1C_4
  int v2; // ST2C_4
  _BYTE *v3; // rax
  _BYTE *v4; // ST30_8
  _BYTE *v5; // rax
  _BYTE *v6; // rax
  int v7; // ST24_4
  _BYTE *v8; // rax
  _BYTE *v9; // ST30_8
  _BYTE *v10; // rax
  _BYTE *v11; // rax
  unsigned int v12; // ST1C_4
  _BYTE *v13; // rax
  _BYTE *v14; // ST30_8
  _BYTE *v15; // rax
  _BYTE *v16; // rax
  signed int i; // [rsp+10h] [rbp-80h]
  unsigned int v19; // [rsp+14h] [rbp-7Ch]
  _BYTE *v20; // [rsp+30h] [rbp-60h]
  _BYTE *v21; // [rsp+38h] [rbp-58h]
  __int64 v22; // [rsp+40h] [rbp-50h]
  __int64 v23; // [rsp+48h] [rbp-48h]
  __int64 v24; // [rsp+50h] [rbp-40h]
  __int64 v25; // [rsp+58h] [rbp-38h]
  __int64 v26; // [rsp+60h] [rbp-30h]
  __int64 v27; // [rsp+68h] [rbp-28h]
  __int64 v28; // [rsp+70h] [rbp-20h]
  __int64 v29; // [rsp+78h] [rbp-18h]
  char v30; // [rsp+80h] [rbp-10h]
  unsigned __int64 v31; // [rsp+88h] [rbp-8h]

  v31 = __readfsqword(0x28u);
  v22 = 5208208757389214273LL;
  v23 = 5786930140093827657LL;
  v24 = 6365651522798441041LL;
  v25 = 7378413942531512921LL;
  v26 = 7957135325236127847LL;
  v27 = 8535856707940741231LL;
  v28 = 3689065129052829815LL;
  v29 = 3398873257388422452LL;
  v30 = 0;
  v19 = strlen(a1);
  v21 = malloc(4 * v19 / 3 + 1);
  v20 = v21;
  for ( i = 0; i < (signed int)(v19 - v19 % 3); i += 3 )
  {
    v1 = (a1[i + 1] << 8) + (a1[i] << 16) + a1[i + 2];
    v2 = a1[i + 2] & 0x3F;
    v3 = v20;
    v4 = v20 + 1;
    *v3 = *((_BYTE *)&v22 + ((v1 >> 18) & 0x3F));
    v5 = v4++;
    *v5 = *((_BYTE *)&v22 + ((v1 >> 12) & 0x3F));
    *v4 = *((_BYTE *)&v22 + ((v1 >> 6) & 0x3F));
    v6 = v4 + 1;
    v20 = v4 + 2;
    *v6 = *((_BYTE *)&v22 + v2);
  }
  if ( v19 % 3 == 1 )
  {
    v7 = 16 * a1[i] & 0x3F;
    v8 = v20;
    v9 = v20 + 1;
    *v8 = *((_BYTE *)&v22 + (((unsigned int)(a1[i] << 16) >> 18) & 0x3F));
    v10 = v9++;
    *v10 = *((_BYTE *)&v22 + v7);
    *v9 = 61;
    v11 = v9 + 1;
    v20 = v9 + 2;
    *v11 = 61;
  }
  else if ( v19 % 3 == 2 )
  {
    v12 = (a1[i] << 16) + (a1[i + 1] << 8);
    v13 = v20;
    v14 = v20 + 1;
    *v13 = *((_BYTE *)&v22 + ((v12 >> 18) & 0x3F));
    v15 = v14++;
    *v15 = *((_BYTE *)&v22 + ((v12 >> 12) & 0x3F));
    *v14 = *((_BYTE *)&v22 + ((v12 >> 6) & 0x3F));
    v16 = v14 + 1;
    v20 = v14 + 2;
    *v16 = 61;
  }
  *v20 = 0;
  return v21;
}

//----- (0000000000000BE7) ----------------------------------------------------
void *__fastcall sub_BE7(const char *a1)
{
  unsigned int v1; // ST1C_4
  _BYTE *v2; // rax
  _BYTE *v3; // rax
  char v4; // dl
  _BYTE *v5; // rax
  char v6; // cl
  _BYTE *v7; // rax
  char v8; // cl
  _BYTE *v9; // rax
  char v10; // dl
  _BYTE *v11; // rax
  char v12; // dl
  char *v13; // rax
  char v14; // dl
  _BYTE *v15; // rax
  char v16; // cl
  _BYTE *v17; // rax
  char v18; // cl
  _BYTE *v19; // rax
  char v20; // dl
  char *s; // [rsp+8h] [rbp-88h]
  unsigned int i; // [rsp+10h] [rbp-80h]
  signed int v24; // [rsp+14h] [rbp-7Ch]
  unsigned int v25; // [rsp+18h] [rbp-78h]
  signed __int64 v26; // [rsp+20h] [rbp-70h]
  signed __int64 v27; // [rsp+20h] [rbp-70h]
  signed __int64 v28; // [rsp+20h] [rbp-70h]
  signed __int64 v29; // [rsp+20h] [rbp-70h]
  char *v30; // [rsp+20h] [rbp-70h]
  signed __int64 v31; // [rsp+20h] [rbp-70h]
  signed __int64 v32; // [rsp+20h] [rbp-70h]
  signed __int64 v33; // [rsp+20h] [rbp-70h]
  void *v34; // [rsp+28h] [rbp-68h]

  s = (char *)a1;
  v1 = strlen(a1);
  v34 = malloc(4 * v1 / 3 + 1);
  v26 = (signed __int64)v34;
  for ( i = v1; i > 0x2D; i -= 45 )
  {
    v2 = (_BYTE *)v26++;
    *v2 = 77;
    v24 = 0;
    while ( v24 <= 44 )
    {
      v3 = (_BYTE *)v26;
      v27 = v26 + 1;
      if ( *s >> 2 )
        v4 = ((unsigned __int8)*s >> 2) + 32;
      else
        v4 = 32;
      *v3 = v4;
      v5 = (_BYTE *)v27;
      v28 = v27 + 1;
      if ( 16 * *s & 0x30 )
        v6 = (16 * *s & 0x30) + 32;
      else
        v6 = 32;
      *v5 = v6 | ((unsigned __int8)s[1] >> 4);
      v7 = (_BYTE *)v28;
      v29 = v28 + 1;
      if ( 4 * s[1] & 0x3C )
        v8 = (4 * s[1] & 0x3C) + 32;
      else
        v8 = 32;
      *v7 = v8 | ((unsigned __int8)s[2] >> 6);
      v9 = (_BYTE *)v29;
      v26 = v29 + 1;
      if ( s[2] & 0x3F )
        v10 = (s[2] & 0x3F) + 32;
      else
        v10 = 32;
      *v9 = v10;
      v24 += 3;
      s += 3;
    }
  }
  v11 = (_BYTE *)v26;
  v30 = (char *)(v26 + 1);
  if ( i )
    v12 = (i & 0x3F) + 32;
  else
    v12 = 32;
  *v11 = v12;
  v25 = 0;
  while ( v25 < i )
  {
    v13 = v30;
    v31 = (signed __int64)(v30 + 1);
    if ( *s >> 2 )
      v14 = ((unsigned __int8)*s >> 2) + 32;
    else
      v14 = 32;
    *v13 = v14;
    v15 = (_BYTE *)v31;
    v32 = v31 + 1;
    if ( 16 * *s & 0x30 )
      v16 = (16 * *s & 0x30) + 32;
    else
      v16 = 32;
    *v15 = v16 | ((unsigned __int8)s[1] >> 4);
    v17 = (_BYTE *)v32;
    v33 = v32 + 1;
    if ( 4 * s[1] & 0x3C )
      v18 = (4 * s[1] & 0x3C) + 32;
    else
      v18 = 32;
    *v17 = v18 | ((unsigned __int8)s[2] >> 6);
    v19 = (_BYTE *)v33;
    v30 = (char *)(v33 + 1);
    if ( s[2] & 0x3F )
      v20 = (s[2] & 0x3F) + 32;
    else
      v20 = 32;
    *v19 = v20;
    v25 += 3;
    s += 3;
  }
  *v30 = 0;
  return v34;
}

//----- (0000000000000F59) ----------------------------------------------------
char *__fastcall sub_F59(const char *a1)
{
  int v1; // ST1C_4
  char *s; // [rsp+8h] [rbp-28h]
  char v4; // [rsp+1Bh] [rbp-15h]
  char *v5; // [rsp+20h] [rbp-10h]
  char *v6; // [rsp+28h] [rbp-8h]

  s = (char *)a1;
  v1 = strlen(a1);
  v6 = (char *)malloc((unsigned int)(v1 + 1));
  v5 = v6;
  while ( *s )
  {
    v4 = *s;
    if ( *s <= 64 || v4 > 90 )
    {
      if ( v4 <= 96 || v4 > 122 )
        *v5 = *s;
      else
        *v5 = (v4 - 84) % 26 + 97;
    }
    else
    {
      *v5 = (v4 - 52) % 26 + 65;
    }
    ++v5;
    ++s;
  }
  *v5 = 0;
  return v6;
}

//----- (000000000000104A) ----------------------------------------------------
__int64 __fastcall main(int a1, char **a2, char **a3)
{
  size_t v3; // rax
  char *dest; // ST18_8
  size_t v5; // rax
  const char *v6; // rax
  char *v7; // rax
  char *v8; // ST18_8

  if ( a1 != 2 )
  {
    puts("./dec_dec_dec flag_string_is_here ");
    exit(0);
  }
  v3 = strlen(a2[1]);
  dest = (char *)malloc(v3 + 1);
  v5 = strlen(a2[1]);
  strncpy(dest, a2[1], v5);
  v6 = sub_860(dest);
  v7 = sub_F59(v6);
  v8 = (char *)sub_BE7(v7);
  if ( !strcmp(v8, s2) )
    puts("correct  :)");
  else
    puts("incorrect :(");
  return 0LL;
}

//----- (0000000000001140) ----------------------------------------------------
void __fastcall init(unsigned int a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r13
  signed __int64 v4; // rbp
  __int64 v5; // rbx

  v3 = a3;
  v4 = &off_201DB0 - off_201DA8;
  init_proc();
  if ( v4 )
  {
    v5 = 0LL;
    do
      ((void (__fastcall *)(_QWORD, __int64, __int64))off_201DA8[v5++])(a1, a2, v3);
    while ( v4 != v5 );
  }
}
// 201DA8: using guessed type __int64 (__fastcall *off_201DA8[2])();
// 201DB0: using guessed type __int64 (__fastcall *off_201DB0)();

//----- (00000000000011B4) ----------------------------------------------------
void term_proc()
{
  ;
}

#error "There were 1 decompilation failure(s) on 11 function(s)"
